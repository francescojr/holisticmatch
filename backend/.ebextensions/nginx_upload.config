files:
  "/etc/nginx/conf.d/client_max_body_size.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      # Allow uploads up to 250MB
      client_max_body_size 250M;
      
      # Also set timeout for large uploads
      client_body_timeout 300s;
      proxy_connect_timeout 300s;
      proxy_send_timeout 300s;
      proxy_read_timeout 300s;

commands:
  01_create_nginx_config:
    command: "mkdir -p /etc/nginx/conf.d && systemctl reload nginx || true"
    ignoreErrors: true
  02_verify_nginx:
    command: "nginx -t && echo 'Nginx config valid'"
    ignoreErrors: true
